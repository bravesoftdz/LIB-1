unit uInputName;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, uGlobal, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, cxContainer, cxEdit, dxSkinsCore, dxSkinCaramel,
  StdCtrls, cxTextEdit, Menus, cxButtons, cxCheckBox, ExtCtrls,
  dxSkinOffice2007Blue, cxMaskEdit, cxSpinEdit;

type
  TfrmInputName = class(TForm)
    Panel1: TPanel;
    txtInput: TcxTextEdit;
    lblInputTitle: TLabel;
    chkUsed: TcxCheckBox;
    btnOK: TcxButton;
    btnClose: TcxButton;
    chkUseAll: TcxCheckBox;
    spinSeq: TcxSpinEdit;
    lblSeq: TLabel;
    procedure FormShow(Sender: TObject);
    procedure btnOKClick(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
    oInput: TInputInfo;
  end;

var
  frmInputName: TfrmInputName;

implementation
{$R *.dfm}

procedure TfrmInputName.btnOKClick(Sender: TObject);
begin
  if length(trim(txtInput.text)) = 0 then
  begin
    oGlobal.Msg('내용(' + oInput.InputTitle + ')을 입력하십시오!');
    txtInput.SetFocus;
    Exit;
  end;

  if (pos('[', trim(oInput.InputTitle)) > 0) or (pos(']', trim(oInput.InputTitle)) > 0) or
    (pos(';', trim(oInput.InputTitle)) > 0) then
  begin
    oGlobal.Msg('(''['','']'','';'') 문자들은 사용하실 수 없습니다!');
    Exit;
  end;

  if oGlobal.YesNo('적용하시겠습니까?') = mrYes then
  begin
    oInput.InputField.Name := trim(txtInput.Text);
    oInput.Used := chkUsed.Checked;
    oInput.UseAll := chkUseAll.Checked;
    oInput.Seq := spinSeq.Value;

    ModalResult := mrOK;
  end;
end;

procedure TfrmInputName.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_ESCAPE then close;
end;

procedure TfrmInputName.FormShow(Sender: TObject);
begin
  lblInputTitle.Caption := oInput.InputTitle;
  txtInput.Text := oInput.InputField.Name;
  txtInput.Properties.MaxLength := oInput.InputField.Size;
  chkUsed.Checked := oInput.Used;

  chkUseAll.Visible := oInput.VisibleWardInfo;
  spinSeq.Visible := oInPut.VisibleWardInfo;
  lblSeq.Visible := oInput.VisibleWardInfo;

  chkUseAll.Checked := oInput.UseAll;
  spinSeq.Value := oInput.Seq;

  txtInput.SetFocus;
  txtInput.SelStart := 0
end;

end.

